import{S as te,i as le,s as se,k as B,J as S,a as C,l as I,m as b,K as O,h as g,c as L,n,L as H,p as D,b as V,G as y,H as R,M as ne,N as G,O as ie,q as A,r as F,u as oe,y as ce,z as _e,A as ue,g as ve,d as he,B as fe}from"./index.6dba7111.js";import"./transform.90f3feb5.js";import{r as J,I as K,o as X,p as Y,h as Q,a as q}from"./all_violence_data.2787399c.js";function U(t,r,e){const s=t.slice();return s[23]=r[e],s[25]=e,s}function W(t){let r,e,s,c,l,h,p,u,_,i,f,o,v,w,k;function x(...d){return t[15](t[23],...d)}return{c(){r=S("g"),e=S("svg"),s=S("svg"),c=S("g"),l=S("path"),_=S("clipPath"),i=S("circle"),this.h()},l(d){r=O(d,"g",{class:!0,transform:!0});var m=b(r);e=O(m,"svg",{class:!0,height:!0,width:!0,viewBox:!0});var z=b(e);s=O(z,"svg",{xmlns:!0,"xml:space":!0,height:!0,width:!0,version:!0,x:!0,y:!0,"xmlns:ns":!0,"enable-background":!0,viewBox:!0});var M=b(s);c=O(M,"g",{"ns:extraneous":!0,class:!0});var P=b(c);l=O(P,"path",{"stroke-width":!0,d:!0,fill:!0,"fill-opacity":!0}),b(l).forEach(g),P.forEach(g),M.forEach(g),z.forEach(g),_=O(m,"clipPath",{id:!0});var E=b(_);i=O(E,"circle",{r:!0}),b(i).forEach(g),E.forEach(g),m.forEach(g),this.h()},h(){n(l,"stroke-width","1.25"),n(l,"d","m62.096 8.5859c-5.208 0-9.424 4.2191-9.424 9.4261 0.001 5.203 4.217 9.424 9.424 9.424 5.202 0 9.422-4.221 9.422-9.424 0-5.208-4.22-9.4261-9.422-9.4261zm-10.41 21.268c-6.672 0-12.131 5.407-12.131 12.07v29.23c0 2.275 1.791 4.123 4.07 4.123 2.28 0 4.127-1.846 4.127-4.123v-26.355h2.102s0.048 68.811 0.048 73.331c0 3.05 2.478 5.53 5.532 5.53 3.052 0 5.525-2.48 5.525-5.53v-42.581h2.27v42.581c0 3.05 2.473 5.53 5.531 5.53 3.054 0 5.549-2.48 5.549-5.53v-73.331h2.127v26.355c0 2.275 1.85 4.123 4.126 4.123 2.28 0 4.073-1.846 4.073-4.123v-29.23c0-6.663-5.463-12.07-12.129-12.07h-20.82z"),n(l,"fill",h=t[0]?t[4](t[23].value):ee),n(l,"fill-opacity",ge),n(c,"ns:extraneous","self"),n(c,"class","svelte-1aa1kfe"),n(s,"xmlns","http://www.w3.org/2000/svg"),n(s,"xml:space","preserve"),n(s,"height","132.24px"),n(s,"width","124.19px"),n(s,"version","1.1"),n(s,"x","0px"),n(s,"y","0px"),n(s,"xmlns:ns","&#38;ns_ai;"),n(s,"enable-background","new 0 0 124.189 132.243"),n(s,"viewBox","75 0 44.189 132.243"),n(e,"class","person svelte-1aa1kfe"),n(e,"height",p=2*t[23].r),n(e,"width",u=2*t[23].r),n(e,"viewBox","0 0 100 120"),n(i,"r",f=t[23].r),n(_,"id",o=`${t[9]}-clip-${t[23].data}`),n(r,"class","node svelte-1aa1kfe"),n(r,"transform",v="translate("+t[23].x+","+t[23].y+")")},m(d,m){V(d,r,m),y(r,e),y(e,s),y(s,c),y(c,l),y(r,_),y(_,i),w||(k=[G(e,"mouseover",x),G(e,"mouseout",t[16])],w=!0)},p(d,m){t=d,m&49&&h!==(h=t[0]?t[4](t[23].value):ee)&&n(l,"fill",h),m&32&&p!==(p=2*t[23].r)&&n(e,"height",p),m&32&&u!==(u=2*t[23].r)&&n(e,"width",u),m&32&&f!==(f=t[23].r)&&n(i,"r",f),m&32&&o!==(o=`${t[9]}-clip-${t[23].data}`)&&n(_,"id",o),m&32&&v!==(v="translate("+t[23].x+","+t[23].y+")")&&n(r,"transform",v)},d(d){d&&g(r),w=!1,ie(k)}}}function Z(t){let r,e=t[3][t[1].data]+"",s,c;return{c(){r=A("Type of violence reported: `"),s=A(e),c=A("`")},l(l){r=F(l,"Type of violence reported: `"),s=F(l,e),c=F(l,"`")},m(l,h){V(l,r,h),V(l,s,h),V(l,c,h)},p(l,h){h&10&&e!==(e=l[3][l[1].data]+"")&&oe(s,e)},d(l){l&&g(r),l&&g(s),l&&g(c)}}}function de(t){let r,e,s,c,l,h,p=t[5],u=[];for(let i=0;i<p.length;i+=1)u[i]=W(U(t,p,i));let _=t[1]!==-1&&Z(t);return{c(){r=B("main"),e=B("div"),s=S("svg");for(let i=0;i<u.length;i+=1)u[i].c();c=C(),l=B("div"),_&&_.c(),this.h()},l(i){r=I(i,"MAIN",{class:!0});var f=b(r);e=I(f,"DIV",{class:!0});var o=b(e);s=O(o,"svg",{width:!0,height:!0,viewBox:!0,fill:!0,class:!0});var v=b(s);for(let k=0;k<u.length;k+=1)u[k].l(v);v.forEach(g),c=L(o),l=I(o,"DIV",{class:!0,style:!0});var w=b(l);_&&_.l(w),w.forEach(g),o.forEach(g),f.forEach(g),this.h()},h(){n(s,"width",j),n(s,"height",t[6]),n(s,"viewBox",-t[7]+" "+-t[8]+" "+j+" "+t[6]),n(s,"fill",pe),n(s,"class","person svelte-1aa1kfe"),n(l,"class",h=H(t[1]===-1?"tooltip-hidden":"tooltip-visible")+" svelte-1aa1kfe"),D(l,"left",t[2].x+2+"px"),D(l,"top",t[2].y-1e3+"px"),n(e,"class","violence_grid svelte-1aa1kfe"),n(r,"class","circles svelte-1aa1kfe")},m(i,f){V(i,r,f),y(r,e),y(e,s);for(let o=0;o<u.length;o+=1)u[o]&&u[o].m(s,null);y(e,c),y(e,l),_&&_.m(l,null)},p(i,[f]){if(f&567){p=i[5];let o;for(o=0;o<p.length;o+=1){const v=U(i,p,o);u[o]?u[o].p(v,f):(u[o]=W(v),u[o].c(),u[o].m(s,null))}for(;o<u.length;o+=1)u[o].d(1);u.length=p.length}i[1]!==-1?_?_.p(i,f):(_=Z(i),_.c(),_.m(l,null)):_&&(_.d(1),_=null),f&2&&h!==(h=H(i[1]===-1?"tooltip-hidden":"tooltip-visible")+" svelte-1aa1kfe")&&n(l,"class",h),f&4&&D(l,"left",i[2].x+2+"px"),f&4&&D(l,"top",i[2].y-1e3+"px")},i:R,o:R,d(i){i&&g(r),ne(u,i),_&&_.d()}}}const j=700,$=3,T=1,pe="black",ee="#ccc",ge=.9;function me(t,r,e){let{data_dot:s=[]}=r,c=Object.values(s),l=c.filter(a=>a.experienced_violence_yn==1),h=-1,p={x:0,y:0};const u=j,_=T,i=T,f=T,o=T;c.map(a=>a);let v=c.map(a=>a.experienced_violence_yn),w=c.map(a=>a.experienced_violence_yn),k=J(v.length).filter(a=>v[a]>=0),x=c.map(a=>a.violence_strings),d=k.map(a=>w[a]);d=new K(d);let m=X(d).domain([0,1]).range(["#2E2F48","#F8553D"]);const z=`O-${Math.random().toString(16).slice(2)}`;let M=Y().size([j-_-i,u-f-o]).radius(a=>6).padding($)(Q({children:k}).sum(a=>v[a])),P=M.leaves();console.log(P);let E=P.sort(function(a,N){return a.x-N.x});E[0].value=1,console.log(E[0].value);for(let a=0;a<l.length;a++)E[a].value=1;for(let a=l.length;a<s.length;a++)E[a].value=0;console.log(d);const ae=(a,N)=>{e(1,h=a),e(2,p={x:N.pageX,y:N.pageY})},re=a=>{e(1,h=-1)};return t.$$set=a=>{"data_dot"in a&&e(10,s=a.data_dot)},t.$$.update=()=>{t.$$.dirty&3072&&(e(11,c=Object.values(s)),l=c.filter(a=>a.experienced_violence_yn==1)),t.$$.dirty&30721&&(c.map(a=>a),e(12,v=c.map(a=>a.experienced_violence_yn)),e(0,w=c.map(a=>a.experienced_violence_yn)),e(13,k=J(v.length).filter(a=>v[a]>=0)),e(3,x=c.map(a=>a.violence_strings)),e(14,d=k.map(a=>w[a])),e(14,d=new K(d)),e(4,m=X(d).domain([0,1]).range(["#2E2F48","#F8553D"]))),t.$$.dirty&12288&&(M=Y().size([j-_-i,u-f-o]).radius(a=>6).padding($)(Q({children:k}).sum(a=>v[a])))},[w,h,p,x,m,E,u,_,f,z,s,c,v,k,d,ae,re]}class ye extends te{constructor(r){super(),le(this,r,me,de,se,{data_dot:10})}}function we(t){let r,e,s,c,l,h,p,u,_,i,f,o;return f=new ye({props:{data_dot:q}}),{c(){r=B("main"),e=B("h3"),s=A("Migrants reporting violence"),c=C(),l=B("div"),h=B("section"),p=B("p"),u=A("Rate of reported violence: "),_=A(t[0]),i=C(),ce(f.$$.fragment),this.h()},l(v){r=I(v,"MAIN",{class:!0});var w=b(r);e=I(w,"H3",{style:!0,class:!0});var k=b(e);s=F(k,"Migrants reporting violence"),k.forEach(g),c=L(w),l=I(w,"DIV",{class:!0});var x=b(l);h=I(x,"SECTION",{class:!0});var d=b(h);p=I(d,"P",{class:!0});var m=b(p);u=F(m,"Rate of reported violence: "),_=F(m,t[0]),m.forEach(g),i=L(d),_e(f.$$.fragment,d),d.forEach(g),x.forEach(g),w.forEach(g),this.h()},h(){D(e,"margin-top","10px"),D(e,"color","#F8553D"),n(e,"class","svelte-oyi84i"),n(p,"class","svelte-oyi84i"),n(h,"class","humans svelte-oyi84i"),n(l,"class","violence_grid svelte-oyi84i"),n(r,"class","svelte-oyi84i")},m(v,w){V(v,r,w),y(r,e),y(e,s),y(r,c),y(r,l),y(l,h),y(h,p),y(p,u),y(p,_),y(h,i),ue(f,h,null),o=!0},p:R,i(v){o||(ve(f.$$.fragment,v),o=!0)},o(v){he(f.$$.fragment,v),o=!1},d(v){v&&g(r),fe(f)}}}function ke(t){let r=q.filter(l=>l.experienced_violence_yn==1),e=q.filter(l=>l.experienced_violence_yn==0),s=Object.keys(r).length/(Object.keys(r).length+Object.keys(e).length);return[Number(s).toLocaleString(void 0,{style:"percent",minimumFractionDigits:2})]}class Oe extends te{constructor(r){super(),le(this,r,ke,we,se,{})}}export{Oe as A,ye as S};
